//hugov@runbox.com
!function(t,s){function i(t){for(var s=Array(t),i=0;i<t;++i){var h=0===i?0:i/(t-1);s[i]=(15+10*h-30*h*h+12*h*h*h)*h*h/7}return s}function h(t,s){for(var i=0,h=t.length;i<h;){var r=i+h>>>1;t[r]<s?i=r+1:h=r}return h}function r(t){this.length=t.length,this.probs=t,this.values=[],this.ranks=[],this.N=0,this.push=n,this._pushMode=e,this._right=a,this._left=l}function n(t){if(Array.isArray(t))for(var s=0;s<t.length;++s)this._pushMode(t[s],h(this.values,t[s]));else this._pushMode(t,h(this.values,t))}function e(t,s){var i=this.values,h=this.ranks;if(++this.N,this.N===this.length&&(this._pushMode=u.bind(this)),s===i.length)return i.push(t),void h.push(this.N);for(var r=s;r<h.length;++r)++h[r];0===s?(i.unshift(t),h.unshift(1)):(this.values.splice(s,0,t),h.splice(s,0,h[s-1]+1))}function u(t,s){var i=this.values,h=this.ranks;if(++this.N,s===i.length)return void this._left(h.length-1,t,this.N);for(var r=s;r<h.length;++r)++h[r];if(0===s)return void this._right(s,t,1);if(t!==i[s]){var n=this.N*this.probs[s-1],e=this.N*this.probs[s],u=h[s]-(h[s]-h[s-1])*(i[s]-t)/(i[s]-i[s-1]);u>e?this._right(s,t,u):u<n&&this._left(s-1,t,u)}}function a(t,s,i){if(!(t>this.values.length-3)){var h=this.values[t],r=this.ranks[t];this.values[t]=s,this.ranks[t]=i,r+this.ranks[t+1]>2*this.N*this.probs[t+1]+2&&this._right(t+1,h,r)}}function l(t,s,i){if(!(t<2)){var h=this.values[t],r=this.ranks[t];this.values[t]=s,this.ranks[t]=i,r+this.ranks[t-1]<2*this.N*this.probs[t-1]&&this._left(t-1,h,r)}}function o(t){if(Array.isArray(t))return t.map(this.quantile,this);var s=(this.N+1)*t,i=h(this.ranks,s);if(i<1)return this.values[0];if(i===this.values.length)return this.values[this.values.length-1];var r=this.ranks[i],n=this.ranks[i-1];return this.values[i-1]+(this.values[i]-this.values[i-1])*(s-n)/(r-n)}module.exports=function(t){return new r(Array.isArray(t)?0===t[0]&&1===t[t.length-1]?t:t.reduce(function(t,s){return t.push(s),t},[0]).map(function(t,s,i){return t/i[i.length-1]}):i(t))},r.prototype={percentile:o,quantile:o,get min(){return this.values[0]},get max(){return this.values[this.values.length-1]}},s.miniQuant=t}({},function(){return this}());